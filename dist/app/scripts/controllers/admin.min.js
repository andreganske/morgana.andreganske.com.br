"use strict";angular.module("myApp").controller("AdminController",["$rootScope","$scope","ParseSDK","$modal","$location","toaster",function(a,b,c,d,e,f){b.tab=0,b.selection=[],b.templates=[{name:"gifts",url:"app/scripts/views/admin_gifts.html"},{name:"guest",url:"app/scripts/views/admin_guests.html"}],b.categories=c.categories,b.init=function(){c.validateLoggedUser(),b.viewGifts()},b.toggle=function(a){a.selected=!a.selected},b.changeTab=function(a){b.tab=a},b.isActiveTab=function(a){return b.tab===a},b.updateGifts=function(){c.getProducts(b)},b.updateGuests=function(){c.getGuests(b)},b.viewGifts=function(){b.pageheader="Nossos presentes",b.template=b.templates[0],b.updateGifts()},b.viewGuests=function(){b.pageheader="Nossos convidados",b.template=b.templates[1],b.updateGuests()},b.logoff=function(){c.logout()},b["new"]=function(){b.selection=[];var a=d.open({templateUrl:"newGift.html",controller:"NewGiftController",scope:b,resolve:{ParseService:function(){return c},action:function(){return"create"}}});a.result.then(function(){b.updateGifts()})},b.getSelected=function(){b.selection=[],$.each(b.products,function(a,c){c.selected&&b.selection.push(c)})},b.edit=function(){if(this.getSelected(),0==b.selection.length)f.pop("warning","Oooops","Parece que voce não selecionou nenhum presente para editar :)",5e3);else if(1!=b.selection.length)f.pop("warning","Oooops","Só conseguimos editar um presente de cada vez. Selecione apenas um (Y)",5e3);else{var a=d.open({templateUrl:"newGift.html",controller:"NewGiftController",scope:b,resolve:{ParseService:function(){return c},action:function(){return"edit"}}});a.result.then(function(){b.updateGifts()})}},b["delete"]=function(){this.getSelected(),c.deleteProduct(b,f)}}]).controller("NewGiftController",function(a,b,c,d,e,f){b.showInfo=!1,1==b.selection.length&&(b.name=b.selection[0].name,b.description=b.selection[0].description,b.category=b.selection[0].category),b.validadeForm=function(){"create"==f?this.save():"edit"==f&&this.edit()},b.handleSaveButton=function(){b.selection.length>0&&b.selection[0].id?this.edit():this.save()},b.save=function(){d.createProduct(b,c,e)},b.edit=function(){d.editProduct(b).done(function(){var a=b.name+" foi alterado e já está disponível na lista de casamento!";e.pop("success","Presente alterado com sucesso!",a,5e3),d.getGuests(b),c.close()})},b.cancel=function(){c.dismiss("cancel")}});